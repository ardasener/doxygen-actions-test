<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.2"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>CS406 - Genetic Course Scheduler: Technical Details</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">CS406 - Genetic Course Scheduler<span id="projectnumber">&#160;0.0.1</span>
   </div>
  </td>
    <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.2 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search",'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('md_pages_technical_details.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Technical Details </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1>General Structure of The Algorithm</h1>
<p ><img src="overall-alg-50.png" alt="" class="inline" title="A Simplified Diagram of the Algorithm"/></p>
<p >The algorithm works by simulating generations of chromosomes. Each chromosome is a schedule. At the end of each generation the fitness of all the chromosomes are calculated. The chromosomes with the best scores are then seperated. Crossovers and mutations are applied on these good chromosomes to create the next generation.</p>
<h1>Crossovers</h1>
<p >A child schedule is created by merging different points (course time slots) of 2 parent schedules. There is a dominant and a recessive parent. The algorithm first copies both parents and sorts both copied parents according to multiple metrics to get them in sync with each other. Then a number of random points are copied from the recessive parent to the copy of the dominant parent. This copy is then used as the child chromosome.</p>
<p >Below is a C-style pseudocode for the algorithm. The actual algorithm is more complicated since it has to account for consecutive class times.</p>
<div class="fragment"><div class="line"><a class="code hl_class" href="classSchedule.html">Schedule</a> crossover(parent1, parent2){</div>
<div class="line">    </div>
<div class="line">    parent1_copy = parent1.copy()</div>
<div class="line">    parent2_copy = parent2.copy()</div>
<div class="line"> </div>
<div class="line">    sort(parent1_copy)</div>
<div class="line">    sort(parent2_copy)</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span>(i=0; i&lt;num_points; i++){</div>
<div class="line">        rand_num = random number between 0, parent1.size</div>
<div class="line">        parent1_copy[rand_num] = parent2_copy[rand_num]</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> parent1_copy</div>
<div class="line">}</div>
<div class="ttc" id="aclassSchedule_html"><div class="ttname"><a href="classSchedule.html">Schedule</a></div><div class="ttdef"><b>Definition:</b> schedule.cpp:22</div></div>
</div><!-- fragment --><h1>Mutations</h1>
<p >After each crossover there is a chance that a mutation can occur. During a mutation, a set number of points are changed randomly. This serves introduce to new qualities to the gene pool. This part also requires sorting since we want to keep the consecutive class times together.</p>
<p >Below is a C-style pseudocode for the algorithm. The actual algorithm is more complicated since it has to account for consecutive class times.</p>
<div class="fragment"><div class="line"><span class="keywordtype">void</span> mutation(chromosome){</div>
<div class="line"> </div>
<div class="line">    sort(chromosome)</div>
<div class="line">    </div>
<div class="line">    <span class="keywordflow">for</span>(i=0; i&lt;num_points; i++){    </div>
<div class="line">        rand_num = random number between 0, chromosome.size</div>
<div class="line">        rand_classroom = randomly choosen classroom</div>
<div class="line">        rand_time_slot = randomly choosen timeslot</div>
<div class="line">        </div>
<div class="line">        chromosome[rand_num].classroom = rand_classroom</div>
<div class="line">        chromosome[rand_num].timeslot = rand_time_slot</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><h1>Handling Consecutive Classes</h1>
<p >Most of the courses have last for more than one hour as such they have to be scheduled into multiple consecutive time slots in the same classroom. As a result the algorithm should account for this during crossovers and mutations as well as generating the initial chromosomes.</p>
<p >To handle this, a root flag was implemented which indicates whether or not that particular course time is the first hour for that course in that day. Then during any operation that involves moving these course times, first an appropriate time slot is selected and the whole class is moved from the root.</p>
<h1>Calculating Fitness Scores</h1>
<p >Fitness score for each chromosome is calculated by comparing each course time in the schedule with all the other course times. To make this process more efficient the schedule is sorted according to time and each course is compared to the ones ahead of it. Also any collision related checks are stopped after the time slot changes.</p>
<p >A penalty is applied to the fitness score for each error, ranging depending on severity.</p>
<div class="fragment"><div class="line"><span class="keywordflow">for each</span> coursetime{</div>
<div class="line">    <span class="keywordflow">for each</span> other coursetime{</div>
<div class="line">        <span class="keywordflow">if</span> error condition {</div>
<div class="line">            fitness += penalty</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line">}</div>
</div><!-- fragment --><h1>OpenMP</h1>
<p >OpenMP is used to parallelize the initialization of the gene pool and the creation of new chromosomes via crossovers and mutations in each generation. During these operations each thread handles a single chromosome at any given time.</p>
<p >If CUDA isn't used OpenMP will also handle fitness calculations. As with mutations and crossovers, each thread will handle a single chromosome at any given time.</p>
<h1>CUDA</h1>
<p >CUDA is used to parallelize the fitness calculations. After the chromosomes for a generation is created using OpenMP parallelism, they are given to the CUDA kernel in bulk and their fitnesses are calculated all together. In CUDA, each thread will handle a different point (course time) of a chromosome at any given time.</p>
<h1>Experimental Features</h1>
<p >A feature called "variable mutations" can be activated from the config file. This will allow the mutation sizes to vary. This was implemented because a schedule may require small or big changes that can not be provided by static sized crossovers or mutations. No formal tests were performed on this option so its effectiveness is not completely clear.</p>
<p >An option to enable hybrid parallelism between CUDA and OpenMP for fitness calculations was implemented as well and can be activated from the config file. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.2 </li>
  </ul>
</div>
</body>
</html>
